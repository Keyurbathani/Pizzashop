@{
    Layout = "_DashboardLayout";
    ViewData["Title"] = "Users";
}

@{
    bool canEdit = bool.Parse(Context.Session.GetString("CanEdit") ?? "false");
    bool canDelete = bool.Parse(Context.Session.GetString("CanDelete") ?? "false");
}


@* TITLE *@
<div class="container-fluid">

    <div class="title d-flex flex-wrap justify-content-between align-items-center py-2 ms-2">

        <h2 class="text-header mb-3"> Users</h2>

        <div class="d-flex mb-2 mb-md-0 modal-footer">

            <div class="input-group w-50">
                <input name="search " id="search" placeholder="Search" class="form-control border-end-0">
                <span class="input-group-text bg-white border-start-0">
                    <i class="fa-solid fa-search"></i>
                </span>
            </div>

            @if(canEdit){
                <a href="/user/addnewuser" class="btn login-btn ms-2 bn-bg">+Add User</a>
            }
           


        </div>

    </div>


    <div class="col bg-white">

        <div class="p-1">

            <div id="data-table" class="mt-2">
                @* Tables *@
            </div>

        </div>

    </div>


</div>

@section Scripts {

    <script>

        var dataTable = $("#data-table");

        @* Load Data On first time page load  *@

            $.ajax({
                type: "GET",
                url: "/User/GetPagedUsers",
                success: function (response) {
                    dataTable.html(response);
                }
            })

        function debounce(func, delay) {
            let timeout;
            return function (...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    func.apply(this, args);
                }, delay);
            };
        }

        var searchchange = debounce(function () {
            loadPagedItems()
        }, 200);

        $("#search").keyup(searchchange);

        var sortColumn = "";
        var isAsc = true;


    </script>

}
