@model Pizzashop.Entity.ViewModels.OrderDetailsVM

@{
    ViewData["Title"] = "Order Details";
    Layout = "_DashboardLayout";
}

<div class="container-fluid new-details">

    <div class="d-flex justify-content-between align-items-center
     py-2">
        <h2 class="text-primary">Ordere Details</h2>
        <a href="/orders/index" class="lologin-btn">Back</a>
    </div>

    <div class="p-2  bg-white mt-1">


        <div class="d-flex align-items-center gap-2">
            <h4 class="text-dark">Order Summary</h4>
            <span class="order-status p-1">@Model.OrderStatus</span>
        </div>


        <div class="d-flex justify-content-between align-items-center">
            <h6>Invoice No : @Model.InvoiceNumber</h6>

            <a asp-action="OrderPrint" asp-route-id="@Model.Id" class="login-btn p-2 rounded" target="_blank">
                <i class="fa-solid fa-share-from-square me-1"></i>Export
            </a>
        </div>

        <div class="d-flex align-items-center gap-3">
            <p>Paid on: </p>
            <p>Placed on: @Model.PlacedOn</p>
            <p>Modified on: @Model.ModifiedOn </p>
            <p>Order Duration: @Model.OrderDuration</p>
        </div>

    </div>



    <div class="d-flex gap-2 w-100 p-2 mt-1">

        <div class="w-50  Details p-3 bg-white">

            <h4 class="text-dark"><img src="~/images/images.png" alt="" style="width: 30px; height: 30px;"
                    class="me-2">Customer Details</h4>

            <div class="mt-3 d-flex flex-column">
                <span class="mt-1">Name: @Model.CustomerDetails.Name</span>
                <span class="mt-1">Phone: @Model.CustomerDetails.Phone </span>
                <span class="mt-1">No Of person : @Model.CustomerDetails.NoOfPerson </span>
                <span class="mt-1">Email: @Model.CustomerDetails.Email </span>
            </div>


        </div>

        <div class="w-50  Details p-3 bg-white">

            <h4 class="text-dark"><img src="~/images/icons/dinner-table.svg" alt="" style="width: 30px; height: 30px;"
                    class="me-2">Table Details</h4>

            <div class="mt-3 d-flex flex-column">
                <span class="mt-1">Table : @string.Join(", ", Model.TablesName)</span>
                <span class="mt-1">Section : @Model.SectionName </span>
            </div>

        </div>

    </div>


    <div class="table-responsive p-2  mt-1 bg-white order-items">

        <h4 class="text-dark">Order Items</h4>

        <table class="table table-hover -sm">

            <thead class="border-dark ">

                <th scope="col" class="text-secondary">Sr. No</th>
                <th scope="col" class="text-secondary">Item</span></th>
                <th scope="col" class="text-secondary">Quantity</th>
                <th scope="col" class="text-secondary">Price</th>
                <th scope="col" class="text-secondary">TotalAmount</th>

            </thead>

            <tbody>
                @{
                    int counter = 1;
                    foreach (var item in Model.OrderItems)
                    {
                        <tr>
                            <td class="text-secondary">@counter</td>
                            <td class="text-secondary">
                                @item.Name
                                @if (item.OrderModifiers.Any())
                                {
                                    <ul class="modifier">
                                        @foreach (var modifier in item.OrderModifiers)
                                        {
                                            <li>@modifier.Name</li>
                                        }
                                    </ul>
                                }
                            </td>
                            <td class="text-secondary">
                                @item.Quantity
                                @if (item.OrderModifiers.Any())
                                {
                                    <ul class="list-unstyled">
                                        @foreach (var modifier in item.OrderModifiers)
                                        {
                                            <li>@modifier.Quantity</li>
                                        }
                                    </ul>
                                }
                            </td>
                            <td class="text-secondary">
                                ₹ @item.Price
                                @if (item.OrderModifiers.Any())
                                {
                                    <ul class="list-unstyled">
                                        @foreach (var modifier in item.OrderModifiers)
                                        {
                                            <li> ₹ @modifier.Price.ToString("N2")</li>
                                        }
                                    </ul>
                                }
                            </td>
                            <td class="text-secondary">
                                ₹@item.ItemTotal

                                <ul class="list-unstyled">
                                    @foreach (var modifier in item.OrderModifiers)
                                    {
                                        <li>₹@modifier.TotalAmount.ToString("N2")</li>
                                    }
                                </ul>

                            </td>
                        </tr>
                        counter++;
                    }
                }
            </tbody>
        </table>
    </div>



    <div class="p-2  mt-1 bg-white">

        <div class="d-flex justify-content-end me-3">

            <div class="tax_mapping">

                <div class="d-flex justify-content-between align-items-center gap-5">
                    <span>Sub Total:</span><span> ₹ @Model.SubTotal.ToString("N2")</span>
                </div>
                
                @foreach (var tax in Model.OrderTaxes)
                {
                    <div class="d-flex justify-content-between align-items-center gap-5order-tax" data-id="@tax.Id"
                        data-type="@tax.Type" data-rate="@tax.Rate">@tax.Name <span><span class="tax-amount"> ₹
                                @tax.TotalTax.GetValueOrDefault().ToString("N2")</span></span></div>
                }


                <div class="d-flex justify-content-between align-items-center gap-5 TotalAmount">
                    <span>Total:</span><span>₹ @Model.TotalAmount.ToString("N2")</span>
                </div>

            </div>
        </div>

    </div>



</div>